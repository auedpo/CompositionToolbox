<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interval Placement Lab</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-shell">
    <div class="app-stack">
      <div class="app-scroll">
        <div class="page">
          <section class="workspace-region">
            <div id="classicRoot">
              <div class="workspace-toolbar panel">
                <div class="panel-header">
                  <div class="panel-title">
                    <h2>Workspace</h2>
                    <p class="hint">Manage tracks, inventory, and desk placements.</p>
                  </div>
                  <div class="panel-actions">
                    <details class="global-config">
                      <summary>Global Config</summary>
                      <div class="global-config-body">
                        <div class="field-row">
                          <div class="field">
                            <label for="midiOut" title="Select a MIDI device for preview playback. This does not affect scoring or placement.">MIDI output</label>
                            <select id="midiOut" title="Select a MIDI device for preview playback. This does not affect scoring or placement.">
                              <option value="">No device</option>
                            </select>
                            <p class="hint">Requires browser permission. Chromium-based browsers only.</p>
                          </div>
                          <div class="field">
                            <label>&nbsp;</label>
                            <button id="midiPreview" type="button" title="Plays the selected permutation through the chosen MIDI device. This is a preview only and does not change any state.">Preview selected</button>
                          </div>
                        </div>
                        <div id="midiParams" class="field-row"></div>
                        <div class="field-row">
                          <div class="field">
                            <label for="guitarTuning" title="Guitar tuning as note names, e.g. EADGBE or E A D G B E. Used for the fretboard visualization only. This does not affect placement or scoring.">Guitar tuning</label>
                            <input id="guitarTuning" type="text" value="EADGBE" title="Guitar tuning as note names, e.g. EADGBE or E A D G B E. Used for the fretboard visualization only. This does not affect placement or scoring." />
                          </div>
                        </div>
                        <div class="global-status">
                          <span id="status" class="status">Ready</span>
                        </div>
                      </div>
                    </details>
                  </div>
                </div>
              </div>
              <div class="workspace-stage">
                <div class="app-dock">
                  <div class="inventory-desk-row" data-lens-scope="shared">
                    <div class="panel inventory-panel">
                      <div class="panel-header">
                        <div class="panel-title">
                          <h2>Inventory</h2>
                          <p id="inventoryCount" class="hint">Inventory empty.</p>
                        </div>
                        <div class="panel-actions filter">
                          <label for="inventorySearch">Search</label>
                          <input id="inventorySearch" type="text" placeholder="name, type, tag" />
                        </div>
                      </div>
                      <div class="panel-body panel-scroll">
                        <div id="inventoryList" class="inventory-list"></div>
                        <div class="panel subpanel">
                          <div class="panel-header">
                            <div class="panel-title">
                              <h3>Details</h3>
                            </div>
                          </div>
                          <div class="panel-body">
                            <div id="inventoryDetails" class="meta-lines"></div>
                          </div>
                        </div>
                      </div>
                      <div class="panel-footer">
                        <button id="inventorySendBtn" type="button" class="ghost">Place selected on Desk</button>
                        <button id="inventoryRemoveBtn" type="button" class="ghost">Remove selected</button>
                      </div>
                    </div>
                    <div class="panel desk-panel">
                      <div class="panel-header">
                        <div class="panel-title">
                          <h2>Desk</h2>
                          <p id="deskCount" class="hint">Desk empty.</p>
                        </div>
                      </div>
                      <div class="panel-body panel-scroll">
                        <div class="desk-controls">
                          <div class="field compact">
                            <label for="deskLane">Lane</label>
                            <input id="deskLane" type="number" min="1" value="1" />
                          </div>
                          <div class="field compact">
                            <label for="deskDuration">Duration</label>
                            <input id="deskDuration" type="number" min="0.25" step="0.25" value="1" />
                          </div>
                          <div class="field compact">
                            <label for="deskGridStep">Grid</label>
                            <input id="deskGridStep" type="number" min="0.05" step="0.05" value="0.25" />
                          </div>
                        </div>
                        <div id="deskLanes" class="desk-lanes"></div>
                        <div class="panel subpanel">
                          <div class="panel-header">
                            <div class="panel-title">
                              <h3>Details</h3>
                            </div>
                          </div>
                          <div class="panel-body">
                            <div id="deskDetails" class="meta-lines"></div>
                          </div>
                        </div>
                      </div>
                      <div class="panel-footer">
                        <button id="deskRemoveBtn" type="button" class="ghost">Remove selected</button>
                      </div>
                    </div>
                  </div>
                </div>
                <div id="workspaceView" class="workspace-view">
                  <div id="workspaceTracks"></div>
                  <div id="workspaceDockSplitter" class="workspace-dock-splitter"></div>
                  <div id="workspaceDock" class="workspace-dock">
                    <div class="dock-header">
                      <div class="dock-title">Dock</div>
                      <button id="dockToggleBtn" class="ghost" type="button">Hide</button>
                    </div>
                    <div id="workspaceDockBody" class="workspace-dock-body"></div>
                  </div>
                </div>
              </div>
            </div>
            <section id="workspace2Root" class="workspace2-root" hidden>
                <header id="ws2Header" class="ws2-header">
                  <div class="ws2-header-left">
                    <div class="ws2-header-title">workspace2</div>
                  </div>
                  <div class="ws2-header-right">
                    <button type="button" class="ghost ws2-config-btn" disabled title="Config menu (placeholder)">Config Menu â€º</button>
                  </div>
                </header>

                <div id="ws2Views" class="ws2-views">
                  <section id="ws2ViewWorkspace" class="ws2-view ws2-view-workspace">
                    <div id="ws2Body" class="ws2-body">
                      <aside id="ws2Sidebar" class="ws2-sidebar">
                        <div id="ws2LensInspector" class="ws2-panel ws2-panel-lens">
                          <div class="ws2-panel-header">Lens inspector</div>
                          <div class="ws2-panel-body"><div class="ws2-placeholder">Select a lens.</div></div>
                        </div>
                        <div id="ws2TrackInspector" class="ws2-panel ws2-panel-track">
                          <div class="ws2-panel-header">Track inspector</div>
                          <div class="ws2-panel-body"><div class="ws2-placeholder">Select a track.</div></div>
                        </div>
                        <div id="ws2LensBrowser" class="ws2-panel ws2-panel-browser">
                          <div class="ws2-panel-header">Lens browser</div>
                          <div class="ws2-panel-body"><div class="ws2-placeholder">Browser (Phase 6).</div></div>
                        </div>
                      </aside>

                      <main id="ws2Main" class="ws2-main">
                        <section id="ws2VizRegion" class="ws2-panel ws2-panel-viz">
                          <div class="ws2-panel-header">Visualizer(s)</div>
                          <div class="ws2-panel-body"><div class="ws2-placeholder">Visualizer region.</div></div>
                        </section>
                        <section id="ws2DraftRegion" class="ws2-panel ws2-panel-drafts">
                          <div class="ws2-panel-header">Drafts</div>
                          <div class="ws2-panel-body"><div class="ws2-placeholder">Drafts region.</div></div>
                        </section>
                      </main>
                    </div>

                    <section id="ws2TracksRegion" class="ws2-tracks">
                      <div class="ws2-tracks-header">Tracks</div>
                      <div class="ws2-tracks-body">
                        <div class="ws2-placeholder">Track lanes (Phase 3).</div>
                      </div>
                    </section>
                  </section>
                  <section id="ws2ViewLibrary" class="ws2-view ws2-view-library" hidden>
                    <div id="ws2LibrarySplit" class="ws2-library-split">
                      <section id="ws2InventoryMount" class="ws2-panel"></section>
                      <section id="ws2DeskMount" class="ws2-panel"></section>
                    </div>
                  </section>
                </div>

                <footer id="ws2Footer" class="ws2-footer">
                  <div id="ws2ViewSwitch" class="ws2-view-switch"></div>
                  <div id="ws2Help" class="ws2-help">
                    <span class="ws2-placeholder">Hover/help (Phase 8).</span>
                  </div>
                </footer>
              </section>
          </section>
  <div id="visualizerPopout" class="visualizer-popout" role="dialog" aria-label="Expanded interval placement visualizer">
    <button type="button" class="ghost popout-close">Close</button>
    <div class="viz-stack">
      <div class="panel subpanel plot-panel">
        <div class="panel-header">
          <div class="panel-title">
            <h3>Placement plot</h3>
          </div>
          <div class="panel-actions">
            <div id="tabBar" class="tabs"></div>
          </div>
        </div>
        <div class="panel-body">
          <div class="plot-wrap">
            <canvas id="plot" width="640" height="720"></canvas>
          </div>
          <p id="anchorSummary" class="hint"></p>
        </div>
      </div>
      <details class="panel subpanel anchor-math">
        <summary>Anchor math</summary>
        <div id="anchorMath" class="meta-lines small"></div>
      </details>
      <div class="viz-meta-row">
        <div class="panel subpanel">
          <div class="panel-header">
            <div class="panel-title">
              <h3>Selected permutation</h3>
            </div>
          </div>
          <div class="panel-body">
            <div id="selectedInfo" class="meta-lines"></div>
            <div id="hoverCountsLine" class="meta-line">hover counts: --</div>
          </div>
        </div>
        <div class="panel subpanel">
          <div class="panel-header">
            <div class="panel-title">
              <h3>Hover dyads</h3>
            </div>
          </div>
          <div class="panel-body">
            <div id="hoverInfo" class="meta-lines"></div>
          </div>
        </div>
      </div>
      <div class="panel subpanel">
        <div class="panel-header">
          <div class="panel-title">
            <h3>Ranked results</h3>
          </div>
          <div class="panel-actions filter">
            <label for="filter">Filter</label>
            <input id="filter" type="text" placeholder="perm or pitch" />
          </div>
        </div>
        <div class="panel-body panel-scroll">
          <div class="table-wrap">
            <table id="resultsTable">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>Permutation</th>
                  <th>Pitches</th>
                  <th>Fav</th>
                  <th>Total</th>
                  <th>Per pair</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="panel subpanel">
        <div class="panel-header">
          <div class="panel-title">
            <h3>Favorites</h3>
          </div>
        </div>
        <div class="panel-body">
          <div id="favoritesList" class="meta-lines"></div>
        </div>
      </div>
      <div class="viz-instruments">
        <div class="panel subpanel">
          <div class="panel-header">
            <div class="panel-title">
              <h3>Keyboard</h3>
            </div>
          </div>
          <div class="panel-body">
            <div id="keyboard" class="keyboard"></div>
          </div>
        </div>
        <div class="panel subpanel">
          <div class="panel-header">
            <div class="panel-title">
              <h3>Fretboard</h3>
            </div>
          </div>
          <div class="panel-body">
            <div id="fretboard" class="fretboard"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="favoritePrompt" class="modal hidden">
    <div class="modal-card">
      <h3>Favorite settings</h3>
      <p id="favoritePromptText" class="modal-text"></p>
      <div class="modal-actions">
        <button id="favoriteSwitchBtn" type="button">Switch to favorite settings</button>
        <button id="favoriteImportBtn" type="button">Import intervals only</button>
        <button id="favoriteCancelBtn" type="button" class="ghost">Cancel</button>
      </div>
    </div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
